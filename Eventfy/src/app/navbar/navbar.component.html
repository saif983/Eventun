<!-- Navigation -->
<nav class="navbar" [class.scrolled]="isScrolled">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16">
      <!-- Logo -->
      <div class="flex items-center">
        <a href="#" class="flex-shrink-0 flex items-center" (click)="navigateToHome()">
          <img src="favicon.ico" alt="EvenTun Logo" class="h-8 w-8 mr-2">
          <span class="text-xl font-bold text-gray-900">EvenTun</span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden sm:ml-6 sm:flex sm:items-center sm:space-x-4">
        <a href="/home" class="px-3 py-2 rounded-md text-sm font-medium text-gray-900 hover:bg-gray-100">Home</a>
        <a href="/tickets" class="px-3 py-2 rounded-md text-sm font-medium text-gray-900 hover:bg-gray-100" >Ticket Store</a>
        <button class="px-3 py-2 rounded-md text-sm font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToQRTicket()">
          <i class="fas fa-qrcode mr-1"></i>
          QR Ticket with AI
        </button>
        <button class="px-3 py-2 rounded-md text-sm font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToQRCheckin()">
          <i class="fas fa-check-circle mr-1"></i>
          QR Check-in
        </button>
        
        <!-- Cart Button -->
        <div class="relative">
          <button (click)="navigateToCart()" class="p-1 rounded-full text-gray-400 hover:text-gray-500 relative">
            <i class="fas fa-shopping-cart text-xl"></i>
            <span *ngIf="cartItemCount > 0" class="absolute -top-1 -right-1 bg-purple-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
              {{ cartItemCount }}
            </span>
          </button>
        </div>
        
        <!-- Authentication buttons -->
        <div *ngIf="!isAuthenticated" class="ml-4">
          <button class="auth-btn auth-btn-primary" (click)="login()">
            <i class="fas fa-sign-in-alt mr-2"></i>
            Sign In
          </button>
        </div>
        <div *ngIf="isAuthenticated" class="relative ml-4 flex items-center space-x-3">
          <!-- User Profile Section -->
          <div class="user-profile-section" (click)="toggleProfileDropdown()">
            <img 
              [src]="currentUser?.picture" 
              [alt]="currentUser?.name || 'User'"
              class="user-avatar"
            >
            <div class="user-info">
              <span class="user-name">{{ currentUser?.name || 'User' }}</span>
              <span class="user-email">{{ currentUser?.email || 'user@example.com' }}</span>
            </div>
            <i class="fas fa-chevron-down ml-2 text-gray-400 transition-transform duration-200" 
               [class.rotate-180]="isProfileDropdownOpen"></i>
          </div>
          
          <!-- Profile Dropdown Menu -->
          <div *ngIf="isProfileDropdownOpen" class="profile-dropdown">
            <div class="profile-dropdown-item" (click)="navigateToProfile()">
              <i class="fas fa-user mr-3"></i>
              <span>Profile</span>
            </div>
            <div class="profile-dropdown-item" (click)="navigateToMyEvents()">
              <i class="fas fa-calendar-alt mr-3"></i>
              <span>My Events</span>
            </div>
            <div class="profile-dropdown-item" (click)="navigateToSettings()">
              <i class="fas fa-cog mr-3"></i>
              <span>Settings</span>
            </div>
            <hr class="my-2 border-gray-200">
            <div class="profile-dropdown-item text-red-600 hover:bg-red-50" (click)="logout()">
              <i class="fas fa-sign-out-alt mr-3"></i>
              <span>Sign Out</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile menu button -->
      <div class="-mr-2 flex items-center sm:hidden">
        <button 
          type="button" 
          (click)="toggleMobileMenu()"
          class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none">
          <span class="sr-only">Open main menu</span>
          <i class="fas fa-bars" *ngIf="!isMobileMenuOpen"></i>
          <i class="fas fa-times" *ngIf="isMobileMenuOpen"></i>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Mobile menu -->
  <div class="sm:hidden" *ngIf="isMobileMenuOpen">
    <div class="px-2 pt-2 pb-3 space-y-1">
      <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToHome()">Home</a>
      <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToTicketStore()">Ticket Store</a>
      <button class="w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToQRTicket()">
        <i class="fas fa-qrcode mr-2"></i>
        QR Ticket with AI
      </button>
      <button class="w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToQRCheckin()">
        <i class="fas fa-check-circle mr-2"></i>
        QR Check-in
      </button>
      <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:bg-gray-100" (click)="navigateToCart()">
        Shopping Cart
        <span *ngIf="cartItemCount > 0" class="ml-2 bg-purple-600 text-white text-xs rounded-full px-2 py-1">
          {{ cartItemCount }}
        </span>
      </a>
      <!-- Mobile Authentication -->
      <div *ngIf="!isAuthenticated">
        <button class="mobile-auth-btn mobile-auth-btn-primary" (click)="login()">
          <i class="fas fa-sign-in-alt mr-2"></i>
          Sign In
        </button>
      </div>
      <div *ngIf="isAuthenticated" class="space-y-2">
        <!-- Mobile User Profile -->
        <div class="mobile-user-profile" (click)="toggleProfileDropdown()">
          <img 
            [src]="currentUser?.picture" 
            [alt]="currentUser?.name || 'User'"
            class="user-avatar-mobile"
          >
          <div class="mobile-user-info">
            <span class="mobile-user-name">{{ currentUser?.name || 'User' }}</span>
            <span class="mobile-user-email">{{ currentUser?.email || 'user@example.com' }}</span>
          </div>
          <i class="fas fa-chevron-down text-gray-400 transition-transform duration-200" 
             [class.rotate-180]="isProfileDropdownOpen"></i>
        </div>
        
        <!-- Mobile Profile Dropdown -->
        <div *ngIf="isProfileDropdownOpen" class="space-y-1 pl-4">
          <button class="mobile-auth-btn mobile-auth-btn-secondary" (click)="navigateToProfile()">
            <i class="fas fa-user mr-2"></i>
            Profile
          </button>
          <button class="mobile-auth-btn mobile-auth-btn-secondary" (click)="navigateToMyEvents()">
            <i class="fas fa-calendar-alt mr-2"></i>
            My Events
          </button>
          <button class="mobile-auth-btn mobile-auth-btn-secondary" (click)="navigateToSettings()">
            <i class="fas fa-cog mr-2"></i>
            Settings
          </button>
        </div>
        
        <button class="mobile-auth-btn mobile-auth-btn-secondary" (click)="logout()">
          <i class="fas fa-sign-out-alt mr-2"></i>
          Sign Out
        </button>
      </div>
    </div>
  </div>
</nav>
